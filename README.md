# MediaSoft
Выполнил Ключников Владислав ИСдо-34

# Задание №5
1.Вывести покупателей с количеством осуществленных покупок:
SELECT 
    Покупатели.Имя, 
    Покупатели.Фамилия, 
    COUNT(Покупки.ID) AS Количествопокупок
FROM 
    Покупатели
JOIN 
    Покупки ON Покупатели.ID = Покупки.Ключпокупателя
GROUP BY 
    Покупатели.ID, Покупатели.Имя, Покупатели.Фамилия;

2. Общую стоимость товаров для каждого покупателя и отсортировать результат в порядке убывания:
SELECT 
    Покупатели.Имя, 
    Покупатели.Фамилия, 
    SUM(Товары.Стоимость) AS Общаястоимость
FROM 
    Покупатели
JOIN 
    Покупки ON Покупатели.ID = Покупки.Ключпокупателя
JOIN 
    Товары ON Покупки.Ключтовара = Товары.ID
GROUP BY 
    Покупатели.ID, Покупатели.Имя, Покупатели.Фамилия
ORDER BY 
    Общаястоимость DESC;

3. Получить покупателей, купивших только один товар:
SELECT 
    Покупатели.Имя, 
    Покупатели.Фамилия
FROM 
    Покупатели
JOIN 
    Покупки ON Покупатели.ID = Покупки.Ключ_покупателя
GROUP BY 
    Покупатели.ID, Покупатели.Имя, Покупатели.Фамилия
HAVING 
    COUNT(Покупки.ID) = 1;
